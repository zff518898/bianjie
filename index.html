<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社交边界感测试</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #f5f7fa; color: #333; line-height: 1.6; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background-color: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); overflow: hidden; }
        
        header {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white; padding: 30px; text-align: center;
        }
        header h1 { font-size: 2.2rem; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .subtitle { font-size: 1.2rem; opacity: 0.9; margin-bottom: 20px; }
        .disclaimer {
            background-color: rgba(255, 255, 255, 0.15);
            border-left: 4px solid #ffcc00; padding: 15px; border-radius: 5px;
            text-align: left; margin-top: 20px; font-size: 0.95rem;
        }
        
        .card { background-color: white; border-radius: 10px; padding: 30px; margin: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); }
        .hidden { display: none !important; }
        
        .options-info {
            display: flex; flex-wrap: wrap; justify-content: space-between; margin: 25px 0; gap: 10px;
        }
        .option-item {
            flex: 1; min-width: 120px; background-color: #f0f5ff; padding: 12px; border-radius: 8px; text-align: center;
        }
        .option-label {
            display: inline-block; width: 30px; height: 30px; background-color: #3498db;
            color: white; border-radius: 50%; line-height: 30px; margin-right: 10px; font-weight: bold;
        }
        
        .btn-primary, .btn-secondary {
            padding: 14px 28px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary { background-color: #3498db; color: white; }
        .btn-primary:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3); }
        .btn-secondary { background-color: #f0f5ff; color: #3498db; border: 2px solid #3498db; }
        .btn-secondary:hover { background-color: #e1e9ff; }
        .actions { display: flex; justify-content: center; gap: 20px; margin-top: 30px; }
        
        #questions-container { margin: 25px 0; }
        .question { margin-bottom: 25px; padding-bottom: 25px; border-bottom: 1px solid #eee; }
        .question:last-child { border-bottom: none; }
        .question-text { font-size: 1.1rem; margin-bottom: 15px; color: #333; font-weight: 600; }
        .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .option {
            background-color: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px 15px;
            cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center;
        }
        .option:hover { background-color: #e9ecef; }
        .option.selected { background-color: #d4e6f1; border-color: #3498db; color: #3498db; }
        .option input { margin-right: 10px; }
        .navigation {
            display: flex; justify-content: space-between; align-items: center; margin-top: 30px;
            padding-top: 20px; border-top: 1px solid #eee;
        }
        #page-info { font-weight: 600; color: #3498db; }
        
        .progress-container { margin: 20px 0; }
        .progress-bar { height: 10px; background-color: #e9ecef; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #3498db, #2c3e50); border-radius: 5px; transition: width 0.5s ease; }
        .progress-text { text-align: center; margin-top: 10px; font-weight: 600; color: #3498db; }
        
        .score-category { margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 10px; }
        .score-category h3 { margin-bottom: 15px; color: #3498db; font-size: 1.4rem; }
        .score-bar { height: 25px; background-color: #e9ecef; border-radius: 12px; overflow: hidden; margin-bottom: 15px; }
        .score-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #3498db, #2c3e50); border-radius: 12px; transition: width 1.5s ease; }
        .score-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .score-details p { margin: 0; font-weight: 600; }
        
        .boundary-card {
            border-radius: 10px; padding: 25px; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        .boundary-card:hover { transform: translateY(-5px); }
        .boundary-card h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-size: 1.4rem; }
        
        .level-low { background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border-left: 6px solid #dc3545; }
        .level-moderate { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 6px solid #ffc107; }
        .level-high { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-left: 6px solid #28a745; }
        .level-very-high { background: linear-gradient(135deg, #cce5ff 0%, #b8daff 100%); border-left: 6px solid #007bff; }
        
        #interpretation { margin-top: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 10px; }
        #interpretation h3 { margin-bottom: 15px; color: #3498db; display: flex; align-items: center; gap: 10px; }
        .recommendation-item { background-color: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #3498db; }
        
        footer { background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 0.9rem; line-height: 1.5; border-top: 1px solid #eee; }
        
        @media (max-width: 768px) {
            .container { border-radius: 0; }
            header h1 { font-size: 1.8rem; flex-direction: column; gap: 10px; }
            .card { padding: 20px; margin: 10px; }
            .options { grid-template-columns: 1fr; }
            .score-details { grid-template-columns: 1fr; gap: 10px; }
            .actions { flex-direction: column; }
            .btn-primary, .btn-secondary { width: 100%; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-shield-alt"></i> 社交边界感测试</h1>
            <p class="subtitle">评估您在人际互动中的边界意识与维护能力</p>
            <div class="disclaimer">
                <p><strong>重要提示：</strong>本测试用于了解个人在社交中的边界感倾向，结果仅供参考，不能替代专业心理评估。</p>
            </div>
        </header>

        <main>
            <!-- 说明部分 -->
            <section id="instructions" class="card">
                <h2><i class="fas fa-info-circle"></i> 测试说明</h2>
                <p>请根据您在<strong>日常生活中</strong>的真实感受，评估每个描述与您的符合程度。答案无对错，请按第一反应作答。</p>
                <p>每个问题有5个选项：</p>
                <div class="options-info">
                    <div class="option-item"><span class="option-label">1</span> 完全不符合</div>
                    <div class="option-item"><span class="option-label">2</span> 比较不符合</div>
                    <div class="option-item"><span class="option-label">3</span> 不确定</div>
                    <div class="option-item"><span class="option-label">4</span> 比较符合</div>
                    <div class="option-item"><span class="option-label">5</span> 完全符合</div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">请回答所有问题以获得准确结果</div>
                </div>
                <button id="start-btn" class="btn-primary">开始测试</button>
            </section>

            <!-- 问卷部分 -->
            <section id="questionnaire" class="card hidden">
                <h2><i class="fas fa-clipboard-list"></i> 社交边界感问卷</h2>
                <div id="questions-container"></div>
                <div class="navigation">
                    <button id="prev-btn" class="btn-secondary"><i class="fas fa-arrow-left"></i> 上一题</button>
                    <span id="page-info">第 <span id="current-page">1</span> 题 / 共 15 题</span>
                    <button id="next-btn" class="btn-secondary">下一题 <i class="fas fa-arrow-right"></i></button>
                </div>
                <button id="submit-btn" class="btn-primary hidden">查看结果</button>
            </section>

            <!-- 结果部分 -->
            <section id="results" class="card hidden">
                <h2><i class="fas fa-chart-bar"></i> 测试结果</h2>
                
                <div class="score-category">
                    <h3>您的社交边界感总分</h3>
                    <div class="score-bar">
                        <div id="total-bar" class="score-fill"></div>
                    </div>
                    <div class="score-details">
                        <p>总分: <span id="total-score">0</span> / 75</p>
                        <p>边界感水平: <span id="boundary-level">中等</span></p>
                        <p>百分位: <span id="percentile">-</span></p>
                    </div>
                </div>
                
                <div id="boundary-summary">
                    <h3><i class="fas fa-heartbeat"></i> 边界感概述</h3>
                    <div id="boundary-summary-content"></div>
                </div>
                
                <div id="interpretation">
                    <h3><i class="fas fa-comment-medical"></i> 结果解读</h3>
                    <div id="interpretation-content"></div>
                </div>
                
                <div class="actions">
                    <button id="restart-btn" class="btn-secondary"><i class="fas fa-redo"></i> 重新测试</button>
                    <button id="print-btn" class="btn-secondary"><i class="fas fa-print"></i> 打印结果</button>
                </div>
            </section>
        </main>

        <footer>
            <p>社交边界感测试 - 基于社交边界理论编制</p>
            <p>© 2023 心理健康工具 | 仅供教育参考使用</p>
        </footer>
    </div>

    <script>
        // 社交边界感问卷 15题（包含反向计分）
        const boundaryQuestions = [
            { id: 1, text: "我很难对别人的请求说'不'。", reversed: true },
            { id: 2, text: "当别人侵犯我的个人空间时，我会明确表达不满。", reversed: false },
            { id: 3, text: "我经常因为害怕得罪人而接受不情愿的邀约。", reversed: true },
            { id: 4, text: "我能够清晰地表达自己的需求和底线。", reversed: false },
            { id: 5, text: "别人向我倾诉太多私事时，我会感到不舒服。", reversed: false },
            { id: 6, text: "我容易被他人的情绪影响，难以保持独立。", reversed: true },
            { id: 7, text: "我会主动维护自己的时间，不让别人随意占用。", reversed: false },
            { id: 8, text: "即使关系很好，我也需要有自己的私人空间。", reversed: false },
            { id: 9, text: "我经常在社交后感到精疲力尽，因为要顾及太多。", reversed: true },
            { id: 10, text: "我会尊重别人的边界，不打听别人隐私。", reversed: false },
            { id: 11, text: "我很难拒绝别人的情感需求，即使自己很累。", reversed: true },
            { id: 12, text: "当别人对我提出不合理要求时，我会直接拒绝。", reversed: false },
            { id: 13, text: "我常常为他人的问题负责，感觉有义务帮忙。", reversed: true },
            { id: 14, text: "我能够区分哪些是自己的责任，哪些是别人的。", reversed: false },
            { id: 15, text: "在关系中，我容易失去自我，迎合他人。", reversed: true }
        ];

        // 边界感水平分级（总分范围15-75）
        const boundaryLevels = [
            { min: 15, max: 30, level: "边界感较弱", class: "level-low", desc: "您倾向于难以设立和维护个人边界，容易过度付出或被他人的需求淹没，可能需要学习更清晰的边界意识。" },
            { min: 31, max: 45, level: "边界感中等", class: "level-moderate", desc: "您有一定的边界意识，但在某些情境下可能仍会感到困难。整体处于大多数人的正常范围。" },
            { min: 46, max: 60, level: "边界感健康", class: "level-high", desc: "您能够较好地设立和维护个人边界，在尊重他人的同时也能保护自己的空间和情感。" },
            { min: 61, max: 75, level: "边界感较强", class: "level-very-high", desc: "您的边界意识非常清晰，能够有效保护自己，但需注意避免过于 rigid 影响亲密关系的建立。" }
        ];

        // 应用状态
        let currentQuestion = 1;
        let answers = new Array(boundaryQuestions.length).fill(null);

        // DOM元素
        const instructionsSection = document.getElementById('instructions');
        const questionnaireSection = document.getElementById('questionnaire');
        const resultsSection = document.getElementById('results');
        const questionsContainer = document.getElementById('questions-container');
        const startBtn = document.getElementById('start-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const restartBtn = document.getElementById('restart-btn');
        const printBtn = document.getElementById('print-btn');
        const currentPageSpan = document.getElementById('current-page');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('社交边界感测试初始化...');
            
            startBtn.addEventListener('click', startQuestionnaire);
            prevBtn.addEventListener('click', goToPrevQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            submitBtn.addEventListener('click', showResults);
            restartBtn.addEventListener('click', restartQuestionnaire);
            printBtn.addEventListener('click', printResults);
            
            renderQuestion();
            updateProgress();
        });

        function startQuestionnaire() {
            instructionsSection.classList.add('hidden');
            questionnaireSection.classList.remove('hidden');
            resultsSection.classList.add('hidden');
            currentQuestion = 1;
            renderQuestion();
        }

        function renderQuestion() {
            questionsContainer.innerHTML = '';
            const question = boundaryQuestions[currentQuestion - 1];
            
            const questionElement = document.createElement('div');
            questionElement.className = 'question';
            questionElement.innerHTML = `
                <div class="question-text">${question.id}. ${question.text}</div>
                <div class="options">
                    ${[1, 2, 3, 4, 5].map(value => `
                        <label class="option ${answers[currentQuestion - 1] === value ? 'selected' : ''}">
                            <input type="radio" name="question-${question.id}" value="${value}" 
                                   ${answers[currentQuestion - 1] === value ? 'checked' : ''}>
                            <span class="option-label">${value}</span> ${getOptionText(value)}
                        </label>
                    `).join('')}
                </div>
            `;
            
            const radioInputs = questionElement.querySelectorAll('input[type="radio"]');
            radioInputs.forEach(input => {
                input.addEventListener('change', function() {
                    answers[currentQuestion - 1] = parseInt(this.value);
                    updateProgress();
                    
                    if (currentQuestion < boundaryQuestions.length) {
                        currentQuestion++;
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    } else {
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    }
                });
            });
            
            questionsContainer.appendChild(questionElement);
            
            if (currentPageSpan) currentPageSpan.textContent = currentQuestion;
            
            if (prevBtn) prevBtn.disabled = currentQuestion === 1;
            if (nextBtn) nextBtn.disabled = currentQuestion === boundaryQuestions.length;
            if (submitBtn) {
                submitBtn.classList.toggle('hidden', currentQuestion !== boundaryQuestions.length);
                
                if (currentQuestion === boundaryQuestions.length && answers[currentQuestion - 1] !== null) {
                    submitBtn.disabled = false;
                } else if (currentQuestion === boundaryQuestions.length) {
                    submitBtn.disabled = true;
                }
            }
        }

        function getOptionText(value) {
            const texts = {
                1: "完全不符合",
                2: "比较不符合",
                3: "不确定",
                4: "比较符合",
                5: "完全符合"
            };
            return texts[value];
        }

        function updateProgress() {
            const answeredCount = answers.filter(answer => answer !== null).length;
            const totalQuestions = boundaryQuestions.length;
            const progressPercentage = (answeredCount / totalQuestions) * 100;
            
            if (progressFill) progressFill.style.width = `${progressPercentage}%`;
            if (progressText) {
                progressText.textContent = `已回答 ${answeredCount} / ${totalQuestions} 题`;
                if (answeredCount === totalQuestions) {
                    progressText.innerHTML = `<strong>所有问题已回答完毕！可以点击"查看结果"</strong>`;
                }
            }
        }

        function goToPrevQuestion() {
            if (currentQuestion > 1) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function goToNextQuestion() {
            if (currentQuestion < boundaryQuestions.length) {
                currentQuestion++;
                renderQuestion();
            }
        }

        // 计算总分（考虑反向计分）
        function calculateScore() {
            let total = 0;
            boundaryQuestions.forEach((q, idx) => {
                const answer = answers[idx];
                if (answer !== null) {
                    if (q.reversed) {
                        // 反向计分：6 - 原始分
                        total += (6 - answer);
                    } else {
                        total += answer;
                    }
                }
            });
            return total;
        }

        function getBoundaryLevel(total) {
            for (let level of boundaryLevels) {
                if (total >= level.min && total <= level.max) return level;
            }
            return boundaryLevels[1]; // 默认中等
        }

        function showResults() {
            const allAnswered = answers.every(answer => answer !== null);
            if (!allAnswered) {
                alert('请回答所有问题后再查看结果！');
                return;
            }
            
            const total = calculateScore();
            const level = getBoundaryLevel(total);
            
            document.getElementById('total-score').textContent = total;
            document.getElementById('boundary-level').textContent = level.level;
            
            // 简单百分位估算
            let percentile = '';
            if (total <= 30) percentile = '低于25%人群';
            else if (total <= 45) percentile = '约25%-75%人群';
            else if (total <= 60) percentile = '约75%-90%人群';
            else percentile = '高于90%人群';
            document.getElementById('percentile').textContent = percentile;
            
            setTimeout(() => {
                const totalBar = document.getElementById('total-bar');
                if (totalBar) {
                    totalBar.style.width = `${(total / 75) * 100}%`;
                }
            }, 100);
            
            generateBoundarySummary(total, level);
            generateInterpretation(total, level);
            
            questionnaireSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function generateBoundarySummary(total, level) {
            const summaryContent = document.getElementById('boundary-summary-content');
            summaryContent.innerHTML = `
                <div class="boundary-card ${level.class}">
                    <h3><i class="fas fa-chart-line"></i> 社交边界感水平: ${level.level}</h3>
                    <p>${level.desc}</p>
                </div>
            `;
        }

        function generateInterpretation(total, level) {
            const interpretationContent = document.getElementById('interpretation-content');
            
            let html = `
                <p>社交边界感指个人在人际互动中保护自己心理和物理空间的能力，得分范围15-75。您的总分<strong>${total}</strong>分，属于<strong>${level.level}</strong>水平。</p>
                <div class="recommendation-item">
                    <h4>结果解读</h4>
                    <p>${level.desc}</p>
                </div>
            `;
            
            interpretationContent.innerHTML = html;
        }

        function restartQuestionnaire() {
            answers = new Array(boundaryQuestions.length).fill(null);
            currentQuestion = 1;
            updateProgress();
            resultsSection.classList.add('hidden');
            instructionsSection.classList.remove('hidden');
            instructionsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function printResults() {
            const printWindow = window.open('', '_blank');
            const total = calculateScore();
            const level = getBoundaryLevel(total);
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>社交边界感测试报告</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
                        h1, h2, h3 { color: #333; }
                        .score-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        .score-table th, .score-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                        .score-table th { background-color: #f2f2f2; }
                        .boundary-box { padding: 15px; margin: 15px 0; border-radius: 8px; }
                        .level-low { background-color: #f8d7da; border-left: 6px solid #dc3545; }
                        .level-moderate { background-color: #fff3cd; border-left: 6px solid #ffc107; }
                        .level-high { background-color: #d4edda; border-left: 6px solid #28a745; }
                        .level-very-high { background-color: #cce5ff; border-left: 6px solid #007bff; }
                        .footer { margin-top: 30px; font-size: 12px; color: #666; text-align: center; }
                    </style>
                </head>
                <body>
                    <h1>社交边界感测试报告</h1>
                    <p><strong>测试日期：</strong> ${new Date().toLocaleDateString('zh-CN')}</p>
                    
                    <h2>总分</h2>
                    <p><strong>总分：</strong> ${total} / 75</p>
                    <p><strong>边界感水平：</strong> ${level.level}</p>
                    
                    <h2>结果解读</h2>
                    <div class="boundary-box ${level.class}">
                        <p>${level.desc}</p>
                    </div>
                    
                    <h2>重要提示</h2>
                    <div class="boundary-box">
                        <p>本测试仅用于自我评估，不能替代专业心理诊断。健康的边界需要在自我保护和开放之间取得平衡。</p>
                    </div>
                    
                    <div class="footer">
                        <p>社交边界感测试 - 基于社交边界理论编制</p>
                        <p>© ${new Date().getFullYear()} 心理健康工具 | 仅供教育参考使用</p>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => printWindow.print(), 250);
        }
    </script>
</body>
</html>